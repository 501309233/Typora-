[TOC]

# 线段树（区间树,Segment Tree）

## 为什么要使用线段树

最经典的线段树问题：区间染色

​		有一面墙，长度为n，每次选择一段区间染色

​		m次操作后，我们可以在[i,j]区间内看见多少种颜色？

|                      | 使用数组实现 | 使用线段树 |
| -------------------- | ------------ | ---------- |
| 染色操作（更新区间） | O(n)         | O(logn)    |
| 查询操作（查询区间） | O(n)         | O(logn)    |

另一类经典问题：区间查询

对于给定区间

更新：更新区间中一个元素或者一个区间的值

查询一个区间[i,j]的最大值，最小值，或者区间数字和

实质：基于区间的统计查询

2017年注册用户中消费最高的用户？消费最少的用户？学习时间最长的用户？

某个太空区间中天体总量？ 

![1573130055489](E:\Typora笔记\数据结构\assets\1573130055489.png)

**线段树不一定是完全二叉树**

**线段树是平衡二叉树（叶子结点的层数最大差距为1）**

**堆也是平衡二叉树**

依然可以用数组表示

如果**区间**有n个元素，数组表示需要有多少个节点？

我们的线段树不考虑添加元素，即区间固定，使用4n的静态空间即可

![1573130740531](E:\Typora笔记\数据结构\assets\1573130740531.png)

